---
title: "Trabajo Estadística Bayesiana"
author:
  - Eugenio Guzmán^[ejguzmanl@udd.cl]
  - Alejandra Molina^[alejandramm@gmail.com]
  - Jaquelin Morillo^[jaquelin.morillo@gmail.com]
  - Diego Ramirez^[diegoramirez.al34@gmail.com]
  - Francisco Villarroel^[fvillarroelr@udd.cl]
date: '2022-08-26'
output: pdf_document

---

```{r setup, include=FALSE, message=FALSE, echo=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=FALSE, include=FALSE, message=FALSE, echo=FALSE, warning=FALSE}
ipak <- function(pkg){
  new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
  if (length(new.pkg)) 
    install.packages(new.pkg, dependencies = TRUE)
  sapply(pkg, require, character.only = TRUE)
}

# usage

packages <- c("cowplot","dplyr","ggplot2","runjags","ggpubr")
ipak(packages)

```


```{r, warning=FALSE, message=FALSE, echo=FALSE, eval=FALSE}
load("Downloads/resultsMod1.Rdata")
load("Downloads/resultsMod2.Rdata")
load("Downloads/resultsMod3.Rdata")
load("Downloads/resultsMod4.Rdata")
load("Downloads/resultsMod5.Rdata")

```


# Introducción


HOLA ESTE ES UN TRABAJO MUY BACán 

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:



# Driff Diffution model

You can also embed plots, for example:


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.ç

# Explicación del experimento

Se observó el comportamiento de veinte personas mientras participaban en un juego de ruleta. Su tarea era apostar por uno de los dos colores (naranjo o celeste). Cada uno de los colores se identifica con la probabilidad de obtener un premio determinado. Algunas ruletas cuentan con un área gris (máscara) que oculta el verdadero color de la sección (ambigüedad).


#Modelación

![](materials/diagram_1.png)

![](materials/diagram_2.png)

# Resultados - Modelos y tablas sumarias


## Modelo 1 

$$ Y_{(ij)} \sim \text { Wiener }(\alpha_{(ij)}, \beta_{(ij)}, \tau_{(ij)}, \delta_{(ij)})$$

Este modelo supone una distribucion Wiener dependiente de los parámetros alfa, beta, tay y delta en función de los sujetos estudiados y los _trials_.


![](results/tables/Mean_Model_1.png)



## Modelo 2

$$Y_{(ij)} \sim \text{Wiener} (\alpha_{(ij)}, \beta_{(ij)}, \tau_{(ij)} \delta_{\left(p_{ij}, o_{ij}\right)})$$

Al igual que el modelo 1  se contemplan los mismos parámetros, con la excepción que el parámetro delta depende linealmente de la probabilidad y del premio normalizado


[chantar toda la wea de graficos y tablas acá]



![](results/tables/Mean_model2.png)


## Modelo 3

$$Y_{(ij)} \sim \text{Wiener} (\alpha_{(ij)}, \beta_{(ij)}, \tau_{(ij)}, \delta_{\left(p_{ij}, o_{ij}\right)})$$

En esta weá p y o dependen cuadráticamente


[chantar toda la wea de graficos y tablas acá]


![](results/tables/mean_model3.png)


## Modelo 4

$$Y_{(ij)} \sim \text{Wiener} (\alpha_{(ij)}, \beta_{(ij)}, \tau_{(ij)}, \delta_{(p_{ij})})$$

sólo p depende cuadráticamente

![](results/tables/mean_model4.png)


## Modelo 5 

$$Y_{(ij)} \sim \text{Wiener} (\alpha_{(ij)}, \beta_{(ij)}, \tau_{(ij)}, \delta_{(o_{ij})})$$

Sólo O depende cuadráticamente


[chantar toda la wea de graficos y tablas acá]

![](results/tables/mean_model5.png)


### Resultados - análisis de parámetros comparados por modelo


#### Alfa Modelo 1

```{r, echo=FALSE}
alfa1.a <-ggdraw() + draw_image("results/plots/Modelo 1/a/Rplot01.png")
alfa1.b <-ggdraw() + draw_image("results/plots/Modelo 1/b/Rplot01.png")
alfa1.c <-ggdraw() + draw_image("results/plots/Modelo 1/c/Rplot01.png")
alfa1.d <-ggdraw() + draw_image("results/plots/Modelo 1/d/Rplot01.png")
alfa1.e <-ggdraw() + draw_image("results/plots/Modelo 1/e/Rplot01.png")


plot_grid(alfa1.a,alfa1.b,alfa1.c,alfa1.d,alfa1.e)

```


#### alfa modelo 2


```{r, echo=FALSE}
alfa2.a <-ggdraw() + draw_image("results/plots/Modelo 2/a/Rplot01.png")
alfa2.b <-ggdraw() + draw_image("results/plots/Modelo 2/b/Rplot01.png")
alfa2.c <-ggdraw() + draw_image("results/plots/Modelo 2/c/Rplot01.png")
alfa2.d <-ggdraw() + draw_image("results/plots/Modelo 2/d/Rplot01.png")
alfa2.e <-ggdraw() + draw_image("results/plots/Modelo 2/e/Rplot01.png")

plot_grid(alfa2.a,alfa2.b,alfa2.c,alfa2.d,alfa2.e)
```


# Alfa Modelo 3

```{r, echo=FALSE}

alfa3.a <-ggdraw() + draw_image("results/plots/Modelo 3/a/Rplot01.png")
alfa3.b <-ggdraw() + draw_image("results/plots/Modelo 3/b/Rplot01.png")
alfa3.c <-ggdraw() + draw_image("results/plots/Modelo 3/c/Rplot01.png")
alfa3.d <-ggdraw() + draw_image("results/plots/Modelo 3/d/Rplot01.png")
alfa3.e <-ggdraw() + draw_image("results/plots/Modelo 3/e/Rplot01.png")

plot_grid(alfa3.a,alfa3.b,alfa3.c,alfa3.d)

```

#### Alfa modelo 4

```{r, echo=FALSE}
alfa4.a <-ggdraw() + draw_image("results/plots/Modelo 4/a/Rplot01.png")
alfa4.b <-ggdraw() + draw_image("results/plots/Modelo 4/b/Rplot01.png")
alfa4.c <-ggdraw() + draw_image("results/plots/Modelo 4/c/Rplot01.png")
alfa4.d <-ggdraw() + draw_image("results/plots/Modelo 4/d/Rplot01.png")
alfa4.e <-ggdraw() + draw_image("results/plots/Modelo 4/e/Rplot01.png")

plot_grid(alfa4.a,alfa4.b,alfa4.c,alfa4.d,alfa4.e)

```


#### Alfa modelo 5

```{r, echo=FALSE}
alfa5.a <-ggdraw() + draw_image("results/plots/Modelo 5/a/Rplot01.png")
alfa5.b <-ggdraw() + draw_image("results/plots/Modelo 5/b/Rplot01.png")
alfa5.c <-ggdraw() + draw_image("results/plots/Modelo 5/c/Rplot01.png")
alfa5.d <-ggdraw() + draw_image("results/plots/Modelo 5/d/Rplot01.png")
alfa5.e <-ggdraw() + draw_image("results/plots/Modelo 5/e/Rplot01.png")

plot_grid(alfa5.a,alfa5.b,alfa5.c,alfa5.d,alfa5.e)

```


### Betas

#### Betas modelo 1

```{r, echo=FALSE}
beta1.a <-ggdraw() + draw_image("results/plots/Modelo 1/a/Rplot02.png")
beta1.b <-ggdraw() + draw_image("results/plots/Modelo 1/b/Rplot02.png")
beta1.c <-ggdraw() + draw_image("results/plots/Modelo 1/c/Rplot02.png")
beta1.d <-ggdraw() + draw_image("results/plots/Modelo 1/d/Rplot02.png")
beta1.e <-ggdraw() + draw_image("results/plots/Modelo 1/e/Rplot02.png")

plot_grid(beta1.a,beta1.b,beta1.c,beta1.e)
```


### Betas modelo 2

```{r, echo=FALSE}
b0.2a <-ggdraw() + draw_image("results/plots/Modelo 2/a/Rplot04.png")
b0.2b <-ggdraw() + draw_image("results/plots/Modelo 2/b/Rplot04.png")
b0.2c <-ggdraw() + draw_image("results/plots/Modelo 2/c/Rplot04.png")
b0.2e <-ggdraw() + draw_image("results/plots/Modelo 2/e/Rplot04.png")
b0.2d <-ggdraw() + draw_image("results/plots/Modelo 2/d/Rplot04.png")

plot_grid(b0.2a,b0.2b,b0.2c,b0.2d,b0.2e)

```



```{r, echo=FALSE}
b1.2a <-ggdraw() + draw_image("results/plots/Modelo 2/a/Rplot05.png")
b1.2b <-ggdraw() + draw_image("results/plots/Modelo 2/b/Rplot05.png")
b1.2c <-ggdraw() + draw_image("results/plots/Modelo 2/c/Rplot05.png")
b1.2d <-ggdraw() + draw_image("results/plots/Modelo 2/d/Rplot05.png")
b1.2e <-ggdraw() + draw_image("results/plots/Modelo 2/e/Rplot05.png")

plot_grid(b1.2a,b1.2b,b1.2c,b1.2d,b1.2e)

```


```{r, echo=FALSE}

beta2.a <-ggdraw() + draw_image("results/plots/Modelo 2/a/Rplot02.png")
beta2.b <-ggdraw() + draw_image("results/plots/Modelo 2/b/Rplot02.png")
beta2.c <-ggdraw() + draw_image("results/plots/Modelo 2/c/Rplot02.png")
beta2.d <-ggdraw() + draw_image("results/plots/Modelo 2/d/Rplot02.png")
beta2.e <-ggdraw() + draw_image("results/plots/Modelo 2/e/Rplot02.png")

plot_grid(beta2.a,beta2.b,beta2.c,beta2.d,beta2.e)

```

```{r, echo=FALSE}
b2.2a <-ggdraw() + draw_image("results/plots/Modelo 2/a/Rplot06.png")
b2.2b <-ggdraw() + draw_image("results/plots/Modelo 2/b/Rplot06.png")
b2.2c <-ggdraw() + draw_image("results/plots/Modelo 2/c/Rplot06.png")
b2.2d <-ggdraw() + draw_image("results/plots/Modelo 2/d/Rplot06.png")
b2.2e <-ggdraw() + draw_image("results/plots/Modelo 2/e/Rplot06.png")

plot_grid(b2.2a,b2.2b,b2.2c,b2.2d,b2.2e)
```

#### Betas modelo 3

```{r, echo=FALSE}
b0.3a <-ggdraw() + draw_image("results/plots/Modelo 3/a/Rplot04.png")
b0.3b <-ggdraw() + draw_image("results/plots/Modelo 3/b/Rplot04.png")
b0.3c <-ggdraw() + draw_image("results/plots/Modelo 3/c/Rplot04.png")
b0.3d <-ggdraw() + draw_image("results/plots/Modelo 3/d/Rplot04.png")
b0.3e <-ggdraw() + draw_image("results/plots/Modelo 3/e/Rplot04.png")


plot_grid(b0.3a,b0.3b,b0.3c,b0.3d,b0.3e)

```


```{r, echo=FALSE}

b1.3a <-ggdraw() + draw_image("results/plots/Modelo 3/a/Rplot05.png")
b1.3b <-ggdraw() + draw_image("results/plots/Modelo 3/b/Rplot05.png")
b1.3c <-ggdraw() + draw_image("results/plots/Modelo 3/c/Rplot05.png")
b1.3d <-ggdraw() + draw_image("results/plots/Modelo 3/d/Rplot05.png")
b1.3e <-ggdraw() + draw_image("results/plots/Modelo 3/e/Rplot05.png")


plot_grid(b1.3a,b1.3b,b1.3c,b1.3d,b1.3e)

```


```{r, echo=FALSE}

b2.3a <-ggdraw() + draw_image("results/plots/Modelo 3/a/Rplot06.png")
b2.3b <-ggdraw() + draw_image("results/plots/Modelo 3/b/Rplot06.png")
b2.3c <-ggdraw() + draw_image("results/plots/Modelo 3/c/Rplot06.png")
b2.3d <-ggdraw() + draw_image("results/plots/Modelo 3/d/Rplot06.png")
b2.3e <-ggdraw() + draw_image("results/plots/Modelo 3/e/Rplot06.png")

plot_grid(b2.3a,b2.3b,b2.3c,b2.3d,b2.3e)

```

```{r, echo=FALSE}
beta3.a <-ggdraw() + draw_image("results/plots/Modelo 3/a/Rplot02.png")
beta3.b <-ggdraw() + draw_image("results/plots/Modelo 3/b/Rplot02.png")
beta3.c <-ggdraw() + draw_image("results/plots/Modelo 3/c/Rplot02.png")
beta3.d <-ggdraw() + draw_image("results/plots/Modelo 3/d/Rplot02.png")
beta3.e <-ggdraw() + draw_image("results/plots/Modelo 3/e/Rplot02.png")


plot_grid(beta3.a,beta3.b,beta3.c,beta3.d,beta3.e)

```


```{r, echo=FALSE}

b3.3a <-ggdraw() + draw_image("results/plots/Modelo 3/a/Rplot07.png")
b3.3b <-ggdraw() + draw_image("results/plots/Modelo 3/b/Rplot07.png")
b3.3c <-ggdraw() + draw_image("results/plots/Modelo 3/c/Rplot07.png")
b3.3d <-ggdraw() + draw_image("results/plots/Modelo 3/d/Rplot07.png")
b3.3e <-ggdraw() + draw_image("results/plots/Modelo 3/e/Rplot07.png")

plot_grid(b3.3a,b3.3b,b3.3c,b3.3d,b3.3e)

```

```{r, echo=FALSE}

b4.3a <-ggdraw() + draw_image("results/plots/Modelo 3/a/Rplot08.png")
b4.3b <-ggdraw() + draw_image("results/plots/Modelo 3/b/Rplot08.png")
b4.3c <-ggdraw() + draw_image("results/plots/Modelo 3/c/Rplot08.png")
b4.3d <-ggdraw() + draw_image("results/plots/Modelo 3/d/Rplot08.png")
b4.3e <-ggdraw() + draw_image("results/plots/Modelo 3/e/Rplot08.png")

plot_grid(b4.3a,b4.3b,b4.3c,b4.3d,b4.3e)

```

#### Betas modelo 4

```{r, echo=FALSE}
b0.4a <-ggdraw() + draw_image("results/plots/Modelo 4/a/Rplot04.png")
b0.4b <-ggdraw() + draw_image("results/plots/Modelo 4/b/Rplot04.png")
b0.4c <-ggdraw() + draw_image("results/plots/Modelo 4/c/Rplot04.png")
b0.4d <-ggdraw() + draw_image("results/plots/Modelo 4/d/Rplot04.png")
b0.4e <-ggdraw() + draw_image("results/plots/Modelo 4/e/Rplot04.png")

plot_grid(b0.4a, b0.4b, b0.4c, b0.4d, b0.4e)

```

```{r, echo=FALSE}
b1.4a <-ggdraw() + draw_image("results/plots/Modelo 4/a/Rplot05.png")
b1.4b <-ggdraw() + draw_image("results/plots/Modelo 4/b/Rplot05.png")
b1.4c <-ggdraw() + draw_image("results/plots/Modelo 4/c/Rplot05.png")
b1.4d <-ggdraw() + draw_image("results/plots/Modelo 4/d/Rplot05.png")
b1.4e <-ggdraw() + draw_image("results/plots/Modelo 4/e/Rplot05.png")

plot_grid(b1.4a,b1.4b,b1.4c,b1.4d,b1.4e)

```

```{r, echo=FALSE}
b3.4a <-ggdraw() + draw_image("results/plots/Modelo 4/a/Rplot06.png")
b3.4b <-ggdraw() + draw_image("results/plots/Modelo 4/b/Rplot06.png")
b3.4c <-ggdraw() + draw_image("results/plots/Modelo 4/c/Rplot06.png")
b3.4d <-ggdraw() + draw_image("results/plots/Modelo 4/d/Rplot06.png")
b3.4e <-ggdraw() + draw_image("results/plots/Modelo 4/e/Rplot06.png")

plot_grid(b3.4a,b3.4b,b3.4c,b3.4d,b3.4e)

```


```{r, echo=FALSE}
beta4.a <-ggdraw() + draw_image("results/plots/Modelo 4/a/Rplot02.png")
beta4.b <-ggdraw() + draw_image("results/plots/Modelo 4/b/Rplot02.png")
beta4.c <-ggdraw() + draw_image("results/plots/Modelo 4/c/Rplot02.png")
beta4.d <-ggdraw() + draw_image("results/plots/Modelo 4/d/Rplot02.png")
beta4.e <-ggdraw() + draw_image("results/plots/Modelo 4/e/Rplot02.png")

plot_grid(beta4.a,beta4.b,beta4.c,beta4.d,beta4.e)

```


### Betas modelo 5

### Beta0

```{r, echo=FALSE}
b0.5a <-ggdraw() + draw_image("results/plots/Modelo 5/a/Rplot04.png")
b0.5b <-ggdraw() + draw_image("results/plots/Modelo 5/b/Rplot04.png")
b0.5c <-ggdraw() + draw_image("results/plots/Modelo 5/c/Rplot04.png")
b0.5d <-ggdraw() + draw_image("results/plots/Modelo 5/d/Rplot04.png")
b0.5e <-ggdraw() + draw_image("results/plots/Modelo 5/e/Rplot04.png")

plot_grid(b0.5a,b0.5b,b0.5c,b0.5d,b0.5e)

```

```{r, echo=FALSE}
b1.5a <-ggdraw() + draw_image("results/plots/Modelo 5/a/Rplot03.png")
b1.5b <-ggdraw() + draw_image("results/plots/Modelo 5/b/Rplot03.png")
b1.5c <-ggdraw() + draw_image("results/plots/Modelo 5/c/Rplot03.png")
b1.5d <-ggdraw() + draw_image("results/plots/Modelo 5/d/Rplot03.png")
b1.5e <-ggdraw() + draw_image("results/plots/Modelo 5/e/Rplot03.png")

plot_grid(b1.5a,b1.5b,b1.5c,b1.5d,b1.5e)

```


```{r,echo=FALSE}
b2.5a <-ggdraw() + draw_image("results/plots/Modelo 5/a/Rplot05.png")
b2.5b <-ggdraw() + draw_image("results/plots/Modelo 5/b/Rplot05.png")
b2.5c <-ggdraw() + draw_image("results/plots/Modelo 5/c/Rplot05.png")
b2.5d <-ggdraw() + draw_image("results/plots/Modelo 5/d/Rplot05.png")
b2.5e <-ggdraw() + draw_image("results/plots/Modelo 5/e/Rplot05.png")

plot_grid(b2.5a,b2.5b,b2.5c,b2.5d,b2.5e)

```


No hay beta3 (???)

```{r, echo=FALSE}
b4.5a <-ggdraw() + draw_image("results/plots/Modelo 5/a/Rplot06.png")
b4.5b <-ggdraw() + draw_image("results/plots/Modelo 5/b/Rplot06.png")
b4.5c <-ggdraw() + draw_image("results/plots/Modelo 5/c/Rplot06.png")
b4.5d <-ggdraw() + draw_image("results/plots/Modelo 5/d/Rplot06.png")
b4.5e <-ggdraw() + draw_image("results/plots/Modelo 5/e/Rplot06.png")

plot_grid(b4.5a,b4.5b,b4.5c,b4.5d,b4.5e)

```

```{r, echo=FALSE}
beta5.a <-ggdraw() + draw_image("results/plots/Modelo 5/a/Rplot03.png")
beta5.b <-ggdraw() + draw_image("results/plots/Modelo 5/b/Rplot03.png")
beta5.c <-ggdraw() + draw_image("results/plots/Modelo 5/c/Rplot03.png")
beta5.d <-ggdraw() + draw_image("results/plots/Modelo 5/d/Rplot03.png")
beta5.e <-ggdraw() + draw_image("results/plots/Modelo 5/e/Rplot03.png")

plot_grid(beta5.a,beta5.b,beta5.c,beta5.d,beta5.e)

```


## Tau


### Tau modelo 1


```{r,echo=FALSE}
tau1.a <-ggdraw() + draw_image("results/plots/Modelo 1/a/Rplot03.png")
tau1.b <-ggdraw() + draw_image("results/plots/Modelo 1/b/Rplot03.png")
tau1.c <-ggdraw() + draw_image("results/plots/Modelo 1/c/Rplot03.png")
tau1.d <-ggdraw() + draw_image("results/plots/Modelo 1/d/Rplot03.png")
tau1.e <-ggdraw() + draw_image("results/plots/Modelo 1/e/Rplot03.png")


plot_grid(tau1.a,tau1.b,tau1.c,tau1.d,tau1.e)
```

### Tau Modelo 2


```{r, echo=FALSE}

tau2.a <-ggdraw() + draw_image("results/plots/Modelo 2/a/Rplot03.png")
tau2.b <-ggdraw() + draw_image("results/plots/Modelo 2/b/Rplot03.png")
tau2.c <-ggdraw() + draw_image("results/plots/Modelo 2/c/Rplot03.png")
tau2.d <-ggdraw() + draw_image("results/plots/Modelo 2/d/Rplot03.png")
tau2.e <-ggdraw() + draw_image("results/plots/Modelo 2/e/Rplot03.png")

plot_grid(tau2.a,tau2.b,tau2.c,tau2.d,tau2.e)
```

### Tau modelo 3

```{r, echo=FALSE}

tau3.a <-ggdraw() + draw_image("results/plots/Modelo 3/a/Rplot03.png")
tau3.b <-ggdraw() + draw_image("results/plots/Modelo 3/b/Rplot03.png")
tau3.c <-ggdraw() + draw_image("results/plots/Modelo 3/c/Rplot03.png")
tau3.d <-ggdraw() + draw_image("results/plots/Modelo 3/d/Rplot03.png")
tau3.e <-ggdraw() + draw_image("results/plots/Modelo 3/e/Rplot03.png")


plot_grid(tau3.a,tau3.b,tau3.c,tau3.d,tau3.e)

```


### Tau modelo 4

```{r, echo=FALSE}
tau4.a <-ggdraw() + draw_image("results/plots/Modelo 4/a/Rplot03.png")
tau4.b <-ggdraw() + draw_image("results/plots/Modelo 4/b/Rplot03.png")
tau4.c <-ggdraw() + draw_image("results/plots/Modelo 4/c/Rplot03.png")
tau4.d <-ggdraw() + draw_image("results/plots/Modelo 4/d/Rplot03.png")
tau4.e <-ggdraw() + draw_image("results/plots/Modelo 4/e/Rplot03.png")

plot_grid(tau4.a,tau4.b,tau4.c,tau4.d,tau4.e)
```


### Tau modelo 5

```{r, echo=FALSE}
tau5.a <-ggdraw() + draw_image("results/plots/Modelo 5/a/Rplot02.png")
tau5.b <-ggdraw() + draw_image("results/plots/Modelo 5/b/Rplot02.png")
tau5.c <-ggdraw() + draw_image("results/plots/Modelo 5/c/Rplot02.png")
tau5.d <-ggdraw() + draw_image("results/plots/Modelo 5/d/Rplot02.png")
tau5.e <-ggdraw() + draw_image("results/plots/Modelo 5/e/Rplot02.png")

plot_grid(tau5.a,tau5.b,tau5.c,tau5.d,tau5.e)

```


### Delta

#### Delta modelo 1

```{r, echo=FALSE}

delta1.a <-ggdraw() + draw_image("results/plots/Modelo 1/a/Rplot04.png")
delta1.b <-ggdraw() + draw_image("results/plots/Modelo 1/b/Rplot04.png")
delta1.c <-ggdraw() + draw_image("results/plots/Modelo 1/c/Rplot04.png")
delta1.d <-ggdraw() + draw_image("results/plots/Modelo 1/d/Rplot04.png")
delta1.e <-ggdraw() + draw_image("results/plots/Modelo 1/e/Rplot04.png")

plot_grid(delta1.a,delta1.b,delta1.c,delta1.d, delta1.e)
```


[chantar toda la wea de graficos y tablas acá]

### Ajuste de modelo DIC y lOO

![](results/tables/DIC.png)



1[](results/tables/LOO.png)



## Comentarios finales







